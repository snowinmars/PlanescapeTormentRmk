// creator  : D:\Games\NearInfinity-exp\app\NearInfinity.jar (v2.4-20250303)
// game     : D:\Games\Steam\steamapps\common\Project P
// resource : DNESTOR.DLG
// source   : data\DLGFiles.bif
// dialog   : lang\ru_RU\dialog.tlk
// dialogF  : (none)

BEGIN ~DNESTOR~
//////////////////////////////////////////////////
// WARNING: this file contains non-trivial WEIGHTs
//////////////////////////////////////////////////

IF WEIGHT #1 /* Triggers after states #: 14 even though they appear after this state */
~  NumTimesTalkedTo(0)
~ THEN BEGIN 0 // from:
  SAY #30119 /* ~Перед тобой пожилой человек в грязной и рваной одежде, неистово метающийся в углу. От него несет вонью, седые волосы торчат во все стороны, а лицо, испачканное землей и засохшей кровью, покрыто серой щетиной. Ежесекундно останавливаясь, он с невнятными проклятиями в чей-то адрес начинает размахивать руками, будто на него накинулся какой-то невидимый враг. За этим занятием он даже не замечает твоего приближения.~ */
  IF ~~ THEN REPLY #30133 /* ~«Приветствую».~ */ GOTO 2
  IF ~~ THEN REPLY #30134 /* ~Оставить мужчину в покое.~ */ EXIT
END

IF WEIGHT #2 /* Triggers after states #: 14 even though they appear after this state */
~  NumTimesTalkedToGT(0)
~ THEN BEGIN 1 // from:
  SAY #30120 /* ~Старик останавливается и обеспокоенно на тебя смотрит. «Вилка? Вилка? Вилка? Не могу попасть домой без своей вилки».~ */
  IF ~  Global("Arlo_Quest","GLOBAL",1)
~ THEN REPLY #30135 /* ~«Послушай... Арло попросил меня избавиться от тебя, так что тебе придется выметаться отсюда».~ */ GOTO 5
  IF ~  Global("Nestor_Quest","GLOBAL",0)
~ THEN REPLY #30136 /* ~«Какая еще вилка?»~ */ GOTO 6
  IF ~  PartyHasItem("NesFork")
~ THEN REPLY #30137 /* ~«Это та вилка, о которой ты говорил?»~ */ DO ~TakePartyItemNum("NesFork",1)
~ GOTO 12
  IF ~~ THEN REPLY #30138 /* ~«Неважно. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 2 // from: 0.0
  SAY #30121 /* ~Старый дурак, выпучив глаза, резко разворачивается на твой голос. Взглянув на тебя, он продолжает свой бред. «Нет! Нет! Нееееееееет! Это не ты... ху-ху! Но скоро... да, скоро».~ */
  IF ~  Global("Arlo_Quest","GLOBAL",1)
~ THEN REPLY #30139 /* ~«Это тебя зовут Нестором?»~ */ GOTO 3
  IF ~~ THEN REPLY #30140 /* ~«Э-э... С кем это ты разговариваешь?»~ */ GOTO 3
  IF ~~ THEN REPLY #30141 /* ~Оставить его в покое.~ */ EXIT
END

IF ~~ THEN BEGIN 3 // from: 2.0 2.1
  SAY #30122 /* ~Кажется, старик начисто забыл о твоем присутствии. «Ху-ху-ху! Ты придешь. Да... ты придешь. Старый Нестор будет ждать!»~ */
  IF ~~ THEN REPLY #30142 /* ~«С тобой все в порядке?»~ */ GOTO 5
  IF ~~ THEN REPLY #30143 /* ~«Ждать? Кого ты будешь ждать?»~ */ GOTO 4
  IF ~  Global("Arlo_Quest","GLOBAL",1)
~ THEN REPLY #30144 /* ~«Послушай... Арло попросил меня избавиться от тебя, так что тебе придется выметаться отсюда».~ */ GOTO 5
  IF ~~ THEN REPLY #30145 /* ~«Неважно. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 4 // from: 3.1
  SAY #30123 /* ~«Ждать, да... — он неожиданно падает на пол, словно от изнурения. — Долго я ждал... ждать». Он делает глубокий вдох и снова поднимается на ноги. «Ждать вечно, если нужно. Ты понял меня?»~ */
  IF ~  Global("Arlo_Quest","GLOBAL",1)
~ THEN REPLY #30146 /* ~«Послушай... Арло попросил меня избавиться от тебя, так что тебе придется выметаться отсюда».~ */ GOTO 5
  IF ~~ THEN REPLY #30147 /* ~«С тобой все в порядке?»~ */ GOTO 5
  IF ~~ THEN REPLY #30148 /* ~«Э-э... Тогда я тебя оставлю в покое. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 5 // from: 1.0 3.0 3.2 4.0 4.1
  SAY #30124 /* ~«Неееееет! — лицо Нестора наливается кровью, его буквально трясет от протеста. — Моя вилка! Не могу уйти без моей вилки! Ху-ху! Вилка, вилка, вилка!»~ */
  IF ~  Global("Nestor_Quest","GLOBAL",0)
~ THEN REPLY #30149 /* ~«Какая еще вилка?»~ */ GOTO 6
  IF ~  Global("Arlo_Quest","GLOBAL",1)
~ THEN REPLY #30150 /* ~«Хватит этой пустой болтовни, старик. Пора уходить... так или иначе».~ */ DO ~IncrementGlobalOnceEx("GLOBALEvil_Nestor_1","GLOBALGood",-1)
~ GOTO 9
  IF ~~ THEN REPLY #30151 /* ~«Похоже, мы зашли в тупик. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 6 // from: 1.1 5.0 11.0
  SAY #30125 /* ~«Вилка? Вилка! Вилка! Не могу попасть домой без своей вилки!» Безумство Нестора достигает предела. Он начинает бешено прыгать, после чего неожиданно останавливается и, пригнув голову, бежит без оглядки прямо на огромный деревянный шкаф, стоящий у стены ночлежки. Сильно ударившись об него, старик оседает назад. Спустя несколько секунд он с изумлением встает. «Исчезла. Украли. Не могу попасть домой без своей вилки».~ */
  IF ~~ THEN REPLY #30152 /* ~«Украли, говоришь? Кто мог взять твою вилку?»~ */ GOTO 7
  IF ~~ THEN REPLY #30153 /* ~«Похоже, мы зашли в тупик. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 7 // from: 6.0
  SAY #30126 /* ~Нестор долго смотрит на тебя, шаря по карманам своей грязной одежды. Спустя несколько секунд он достает нечто, что оказывается оторванным ухом. Судя по запаху и цвету уха, ты делаешь вывод, что старый псих держал его в кармане довольно долго. «У тебя моя вилка, нет? Не у тебя! Ху-ху!» Он обращается к уху, словно разговаривая с ним: «Верни мою вилку!»~ */
  IF ~  Global("Arlo_Quest","GLOBAL",1)
Global("Nestor_Quest","GLOBAL",0)
~ THEN REPLY #30154 /* ~«Если я найду твою вилку, ты уйдешь?»~ */ GOTO 8
  IF ~  Global("Nestor_Quest","GLOBAL",0)
~ THEN REPLY #30155 /* ~«Возможно, я помогу тебе».~ */ DO ~IncrementGlobalOnceEx("GLOBALGood_Nestor_1","GLOBALGood",1)
~ GOTO 8
  IF ~~ THEN REPLY #30156 /* ~«Э-э... Неважно. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 8 // from: 7.0 7.1
  SAY #30127 /* ~«Ждать! Ждать! Ждать! Ху-ху!» Он неистово трясет ухом, словно пытается докричаться до него: «Пока ты не принесешь ее назад! И тогда я вернусь домой!»~ */
  IF ~  PartyHasItem("NesFork")
~ THEN REPLY #30157 /* ~«Это та вилка, о которой ты говорил?»~ */ DO ~TakePartyItemNum("NesFork",1)
~ GOTO 12
  IF ~~ THEN REPLY #30158 /* ~«Хорошо. Я попытаюсь найти твою вилку. Прощай».~ */ DO ~SetGlobal("Nestor_Quest","GLOBAL",1)
~ JOURNAL #29868 /* ~Я согласился помочь психу Нестору из Ночлежки найти его вилку. Бедолага явно спятил, раз держит у себя в кармане оторванное ухо и разговаривает с ним, будто оно может услышать его. Хотя вроде большого вреда от того, что я поищу его вилку, не будет.~ */ EXIT
  IF ~~ THEN REPLY #30159 /* ~«Неважно. У меня есть дела поважнее, чем охота на столовое серебро какого-то психа. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 9 // from: 5.1
  SAY #30128 /* ~«Нееет! Не могу попасть домой без моей вилки!» — он отстраняется от тебя, рыча и скаля зубы, словно загнанное животное.~ */
  IF ~~ THEN REPLY #30160 /* ~Взять его в охапку.~ */ DO ~IncrementGlobalOnceEx("GLOBALEvil_Nestor_2","GLOBALGood",-1)
~ GOTO 10
  IF ~~ THEN REPLY #30161 /* ~«Послушай, я не желаю тебе вреда... но ты *должен* уйти».~ */ GOTO 11
  IF ~~ THEN REPLY #30162 /* ~«Ну хорошо, разбирайся тогда сам. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 10 // from: 9.0
  SAY #30129 /* ~Ты пытаешься схватить его, однако старик оказался для своих лет довольно ловким. Опередив тебя, он уворачивается и вонзается зубами в протянутую руку. Почувствовав боль, ты одергиваешь руку.~ */
  IF ~~ THEN REPLY #30163 /* ~«Ну хорошо. Теперь будем по-плохому...»~ */ DO ~Enemy()
Attack(Protagonist)
ForceAttack(Protagonist,Myself)
~ EXIT
  IF ~~ THEN REPLY #30164 /* ~«Послушай, я не желаю тебе вреда... но ты *должен* уйти».~ */ GOTO 11
  IF ~~ THEN REPLY #30165 /* ~«Ну хорошо, разбирайся тогда сам. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 11 // from: 9.1 10.1
  SAY #30130 /* ~Нестор немного успокаивается, на его глазах наворачиваются слезы. «Не могу попасть домой. Не могу. Не могу. Не могу. Только с вилкой».~ */
  IF ~  Global("Nestor_Quest","GLOBAL",0)
~ THEN REPLY #30166 /* ~«Какая еще вилка?»~ */ GOTO 6
  IF ~~ THEN REPLY #30167 /* ~«Похоже, мы зашли в тупик. Прощай».~ */ EXIT
END

IF ~~ THEN BEGIN 12 // from: 1.2 8.0
  SAY #30131 /* ~Нестор выхватывает вилку из рук. «Моя вилка? Моя вилка! Вилка! Вилка! Вилка! Ху-ху!» От радости он неистово прыгает, размахивая вилкой над головой по какой-то причудливой траектории, словно проводя какой-то странный ритуал. «Теперь я могу попасть домой! Прощай! Ху-ху!»~ */
  IF ~~ THEN REPLY #30168 /* ~«Прощай, Нестор».~ */ GOTO 13
END

IF ~~ THEN BEGIN 13 // from: 12.0
  SAY #30132 /* ~Уже собираясь уходить, Нестор замирает в раздумье, после чего поворачивается и протягивает тебе что-то мягкое: оторванное ухо. Внимательно осмотрев его, ты замечаешь, что на нем до сих пор висит какая-то серьга.~ */
  IF ~~ THEN REPLY #30169 /* ~Забрать серьгу и выбросить гнилой кусок плоти.~ */ DO ~GiveItemCreate("ObEar",Protagonist,1,0,0)
SetGlobal("Nestor_Quest","GLOBAL",2)
AddexperienceParty(500)
~ JOURNAL #28825 /* ~Я вернул Нестору вилку. Она оказалась портальным ключом или что-то вроде того. Получив свою вещь, Нестор теперь может вернуться туда, откуда пришел. Интересно, сколько времени этот бедолага слонялся по Сигилу, не имея возможности вернуться домой?~ */ EXIT
END

IF WEIGHT #0 ~  NumTimesTalkedToGT(0)
Global("Nestor_Quest","GLOBAL",2)
~ THEN BEGIN 14 // from:
  SAY #61633 /* ~Нестор полностью тебя игнорирует, его взгляд прикован к шкафу у стены.~ */
  IF ~~ THEN REPLY #61634 /* ~Уйти.~ */ EXIT
END
